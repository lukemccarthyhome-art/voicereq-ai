<div class="card" style="padding:24px; max-width:1000px; margin:0 auto;">
  <h2>Design: <%= design.id %></h2>
  <div style="margin-top:12px">
    <div><strong>Owner:</strong> <%= design.owner %></div>
    <div><strong>Created:</strong> <%= new Date(design.createdAt).toLocaleString() %></div>
  </div>
  <div style="margin-top:12px">
    <div style="display:flex;align-items:center;justify-content:space-between">
      <h3>Design Summary</h3>
      <div style="display:flex;gap:8px;align-items:center">
        <form method="POST" action="/admin/projects/<%= projectId %>/extract-design" style="margin:0">
          <button type="submit" class="btn btn-sm" style="background:#f59e0b;border-radius:8px">ğŸ”„ Refresh design</button>
        </form>
        <button id="generateFlowchart" class="btn btn-sm" style="background:#06b6d4;border-radius:8px">ğŸ—ºï¸ Generate flowchart</button>
      </div>
    </div>
    <div style="border:1px solid #eee;padding:16px;border-radius:8px;background:#ffffff; box-shadow: 0 2px 6px rgba(16,24,40,0.04);">
      <div style="color:#111; font-size:14px; line-height:1.5"><%- design.designHtml %></div>
    </div>
  </div>
  <div style="margin-top:12px">
    <h3>Questions</h3>
    <div style="display:flex;flex-direction:column;gap:10px">
      <% design.questions.forEach(function(q,i){ %>
        <form method="POST" action="/admin/projects/<%= projectId %>/design/answer" style="display:flex;gap:8px;align-items:center">
          <input type="hidden" name="designId" value="<%= design.id %>" />
          <input type="hidden" name="question" value="<%= q %>" />
          <label style="flex:1; font-weight:600"><%= q %></label>
          <input type="text" name="answer" placeholder="Type your answer here" style="flex:2;padding:8px;border:1px solid #e2e8f0;border-radius:6px" />
          <button type="submit" class="btn btn-sm">Save</button>
        </form>
      <% }) %>
    </div>
  </div>
  <div style="margin-top:12px">
    <h3>Admin Chat</h3>
    <div style="border:1px solid #eee;padding:12px;border-radius:8px; max-height:260px; overflow:auto; background:#fff">
      <% design.chat.forEach(c=>{ %>
        <div style="margin-bottom:12px; padding:8px; border-radius:6px; background:#f8fafc">
          <div style="font-weight:700; font-size:13px; color:#0f172a"><%= c.from %> <span style="font-weight:400; color:#6b7280; font-size:12px">â€” <%= new Date(c.ts).toLocaleString() %></span></div>
          <div style="margin-top:6px; color:#0f172a"><%= c.text %></div>
        </div>
      <% }) %>
      <% if (design.chat.length === 0) { %>
        <div style="color:#6b7280; padding:12px;">No admin messages yet. Use the box below to start a conversation about this design.</div>
      <% } %>
    </div>
    <form method="POST" action="/admin/projects/<%= projectId %>/design/chat" style="margin-top:8px">
      <input type="hidden" name="designId" value="<%= design.id %>" />
      <textarea name="text" rows="3" style="width:100%"></textarea>
      <div style="margin-top:8px"><button class="btn">Send</button></div>
    </form>
  </div>
</div>