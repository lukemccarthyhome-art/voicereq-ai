<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %> - Morti Projects</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root { --bg-deep: #0a1628; --bg-glass: rgba(15, 29, 50, 0.6); --border-glass: rgba(255, 255, 255, 0.08); --border-glass-hover: rgba(255, 255, 255, 0.15); --accent: #1199fa; --accent-dim: rgba(17, 153, 250, 0.12); --text-primary: #f0f4f8; --text-secondary: rgba(240, 244, 248, 0.7); --text-muted: rgba(240, 244, 248, 0.4); --radius: 16px; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background: var(--bg-deep); color: var(--text-primary); line-height: 1.6; -webkit-font-smoothing: antialiased; }
        a { text-decoration: none; color: inherit; }
        .main { max-width: 1100px; margin: 0 auto; padding: 24px 20px; }
        .breadcrumb { font-size: 13px; color: var(--text-muted); margin-bottom: 16px; }
        .breadcrumb a { color: var(--accent); }
        .breadcrumb a:hover { text-decoration: underline; }
        .card { background: var(--bg-glass); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid var(--border-glass); border-radius: var(--radius); padding: 24px; margin-bottom: 20px; }
        .category { margin-bottom: 24px; }
        .category h3 { font-size: 16px; color: var(--accent); margin-bottom: 8px; padding-bottom: 6px; border-bottom: 2px solid var(--accent-dim); }
        .category ul { list-style: none; padding: 0; }
        .category li { padding: 8px 12px; margin-bottom: 4px; background: rgba(5,13,26,0.4); border-radius: 8px; font-size: 14px; border-left: 3px solid var(--accent); color: var(--text-secondary); }
    </style>
</head>
<body>
    <%- include('../partials/admin-nav', { currentPage: 'projects', user: user }) %>
    <main class="main">
        <div class="breadcrumb">
            <a href="/admin">Dashboard</a> ‚Ä∫ <a href="/admin/projects">Projects</a>
                <a href="/admin/projects">Projects</a> ‚Ä∫ <a href="/admin/projects/<%= encodeId(project.id) %>"><%= project.name %></a> ‚Ä∫ Requirements
        </div>
        <div class="card">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
                <h2 style="font-size:1.3rem;font-weight:700;">üìã Project Requirements</h2>
                <a href="/admin/projects/<%= encodeId(project.id) %>" style="color:var(--accent);font-size:14px;">‚Üê Back to Project</a>
            </div>
            <p style="color: var(--text-muted); font-size: 14px; margin-bottom: 24px;">Aggregated requirements from all sessions for <strong><%= project.name %></strong> (<%= project.company %>).</p>
            <% const cats = Object.keys(requirements); %>
            <% if (cats.length > 0) { %>
                <% const order = ['Project Overview','Stakeholders','Functional Requirements','Non-Functional Requirements','Business Rules','User Workflows','Integrations','Data & Content','Constraints','Success Criteria','Cost & Value']; %>
                <% const ordered = order.filter(c => requirements[c]).concat(cats.filter(c => !order.includes(c))); %>
                <% ordered.forEach(cat => { %>
                    <% if (requirements[cat] && requirements[cat].length > 0) { %>
                    <div class="category">
                        <h3><%= cat %> (<%= requirements[cat].length %>)</h3>
                        <ul>
                            <% requirements[cat].forEach(item => { %>
                            <li><%= item %></li>
                            <% }) %>
                        </ul>
                    </div>
                    <% } %>
                <% }) %>
                <div style="padding:12px;background:rgba(5,13,26,0.4);border:1px solid var(--border-glass);border-radius:12px;font-size:13px;color:var(--text-muted);">
                    Total: <%= Object.values(requirements).reduce((s,a) => s + (Array.isArray(a) ? a.length : 0), 0) %> requirements across <%= cats.length %> categories
                </div>
            <% } else { %>
                <div style="text-align: center; padding: 40px; color: var(--text-muted);">
                    <div style="font-size: 48px; margin-bottom: 16px;">üìã</div>
                    <h3 style="color: var(--text-secondary);">No requirements extracted yet</h3>
                    <p>Sessions need to be completed first</p>
                </div>
            <% } %>
        </div>
    </main>
</body>
</html>
